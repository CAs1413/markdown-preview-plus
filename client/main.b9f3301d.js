parcelRequire=function(e,r,n){var t="function"==typeof parcelRequire&&parcelRequire,i="function"==typeof require&&require;function u(n,o){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!o&&f)return f(n,!0);if(t)return t(n,!0);if(i&&"string"==typeof n)return i(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}a.resolve=function(r){return e[n][1][r]||r};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,a,l,l.exports)}return r[n].exports;function a(e){return u(a.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=t;for(var o=0;o<n.length;o++)u(n[o]);return u}({7:[function(require,module,exports) {
"use strict";function e(e){e&&e.catch(function(e){console.error(e)})}exports.__esModule=!0,exports.handlePromise=e;var t=require("fs");function n(e){return!!t.existsSync(e)&&t.lstatSync(e).isFile()}function r(e){return e.nodeType===Node.ELEMENT_NODE}function o(e){if("markdown-preview-plus-view"===e.tagName.toLowerCase())return[{tag:"div",index:0}];for(var t=i(e=a(e)),n=e.parentElement.children,r=0,s=0,l=Array.from(n);s<l.length;s++){var c=l[s],u=1===c.nodeType?i(c):null;if(c===e){var f=o(e.parentElement);return f.push({tag:t,index:r}),f}u===t&&r++}throw new Error("failure in getPathToElement")}function a(e){for(var t=e;;){var n=t.parentElement;if(!n)break;if(n.classList.contains("MathJax_Display"))return n.parentElement;if(n.classList.contains("atom-text-editor"))return n;t=n}return e}function i(e){return e.classList.contains("math")?"math":e.classList.contains("atom-text-editor")?"code":e.tagName.toLowerCase()}exports.isFileSync=n,exports.isElement=r,exports.getPathToElement=o,exports.bubbleToContainerElement=a,exports.encodeTag=i;
},{}],8:[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,u){function a(e){try{s(o.next(e))}catch(e){u(e)}}function i(e){try{s(o.throw(e))}catch(e){u(e)}}function s(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(a,i)}s((o=o.apply(e,t||[])).next())})},t=this&&this.__generator||function(e,t){var n,o,r,u,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return u={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function i(u){return function(i){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=o[2&u[0]?"return":u[0]?"throw":"next"])&&!(r=r.call(o,u[1])).done)return r;switch(o=0,r&&(u=[0,r.value]),u[0]){case 0:case 1:r=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,o=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===u[0]||2===u[0])){a=0;continue}if(3===u[0]&&(!r||u[1]>r[0]&&u[1]<r[3])){a.label=u[1];break}if(6===u[0]&&a.label<r[1]){a.label=r[1],r=u;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(u);break}r[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],o=0}finally{n=r=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,i])}}};exports.__esModule=!0,exports.mathJaxStub={jaxConfigure:function(e,t){MathJax.Hub.Config({jax:["input/TeX","output/"+t],extensions:[],TeX:{extensions:["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"],Macros:e},"HTML-CSS":{availableFonts:[],webFont:"TeX"},messageStyle:"none",showMathMenu:!1,skipStartupTypeset:!0}),MathJax.Hub.Configured()},queueTypeset:function(n){return e(this,void 0,void 0,function(){return t(this,function(e){return n.forEach(function(e){MathJax.Hub.Queue(["Typeset",MathJax.Hub,e])}),[2,new Promise(function(e){MathJax.Hub.Queue([e])})]})})}};
},{}],6:[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function u(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})},t=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}},n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};exports.__esModule=!0;var r,i=require("path"),o=require("season"),a=require("fs"),u=require("./util"),s=!1,c=global.require.resolve("mathjax")+"?delayStartupUntil=configured";function l(n,r){return e(this,void 0,void 0,function(){return t(this,function(e){switch(e.label){case 0:return s?[2]:[4,h(r)];case 1:return[4,e.sent().queueTypeset(n)];case 2:return e.sent(),[2]}})})}function d(n){return e(this,void 0,void 0,function(){var e,r;return t(this,function(t){switch(t.label){case 0:return s?[2,n.innerHTML]:[4,h("SVG")];case 1:return[4,t.sent().queueTypeset([n])];case 2:return t.sent(),e=document.getElementById("MathJax_SVG_Hidden"),null!==(r=e&&e.parentNode.cloneNode(!0))&&n.insertBefore(r,n.firstChild),[2,n.innerHTML]}})})}function f(e){s=e}function h(n){return e(this,void 0,void 0,function(){return t(this,function(e){return r?[2,r]:[2,r=S(n)]})})}function v(){r=void 0;var e=document.head.querySelector("script[src='"+c+"']");e&&e.remove()}function p(){return e(this,void 0,void 0,function(){var e,n;return t(this,function(t){switch(t.label){case 0:return[4,window.atomHome];case 1:return e=t.sent(),[2,null!=(n=o.resolve(i.join(e,"markdown-preview-plus")))?n:i.join(e,"markdown-preview-plus.cson")]}})})}function m(e){return o.isObjectPath(e)?o.readFileSync(e,function(t,n){return void 0===n&&(n={}),void 0!==t&&(console.warn("Error reading Latex Macros file '"+e+"': "+(void 0!==t.stack?t.stack:t)),console.error("Failed to load Latex Macros from '"+e+"'",{detail:t.message,dismissable:!0})),n}):{}}function b(){return e(this,void 0,void 0,function(){var e;return t(this,function(t){switch(t.label){case 0:return[4,p()];case 1:return e=t.sent(),u.isFileSync(e)?[2,m(e)]:(console.debug("Creating markdown-preview-plus.cson, this is a one-time operation."),w(e),[2,m(e)])}})})}function w(e){var t=i.join(__dirname,"../assets/macros-template.cson"),n=a.readFileSync(t,"utf8");a.writeFileSync(e,n)}function y(e){var t=/^[^a-zA-Z\d\s]$|^[a-zA-Z]*$/;for(var n in e){var r=e[n];n.match(t)&&g(r)||(delete e[n],console.error("Failed to load LaTeX macro named '"+n+"'. Please see the [LaTeX guide](https://github.com/atom-community/markdown-preview-plus/blob/master/docs/math.md#macro-names)"))}return e}function g(e){if(Array.isArray(e)){var t=e[0],n=e[1];return"number"==typeof n&&(n%1==0&&"string"==typeof t)}return"string"==typeof e}function x(n,r){return e(this,void 0,void 0,function(){var e;return t(this,function(t){switch(t.label){case 0:return[4,b()];case 1:return e=(e=t.sent())?y(e):{},n.jaxConfigure(e,r),console.log("Loaded maths rendering engine MathJax"),[2]}})})}function S(r){return e(this,void 0,void 0,function(){var e;return t(this,function(t){switch(t.label){case 0:return console.log("Loading maths rendering engine MathJax"),[4,Promise.all([_(c)])];case 1:return t.sent(),[4,Promise.resolve().then(function(){return n(require("./mathjax-stub"))})];case 2:return[4,x(e=t.sent().mathJaxStub,r)];case 3:return t.sent(),[2,e]}})})}function _(n){return e(this,void 0,void 0,function(){var e;return t(this,function(t){return(e=document.createElement("script")).src=n,e.type="text/javascript",document.head.appendChild(e),[2,new Promise(function(t){e.addEventListener("load",function(){return t()})})]})})}exports.mathProcessor=l,exports.processHTMLString=d,exports.testing={loadMathJax:h,disableMathJax:f,unloadMathJax:v},exports.injectScript=_;
},{"./util":7,"./mathjax-stub":8}],5:[function(require,module,exports) {
"use strict";exports.__esModule=!0;var e=require("morphdom"),r=require("./mathjax-helper"),t=require("./util"),n=function(){function n(e){this.dom=e}return n.prototype.update=function(n,o,i){for(var a=n.cloneNode(!0),u=function(e){var r=e.firstElementChild;if(!r||"SCRIPT"!==r.nodeName)return"continue";e.isSameNode=function(e){if("SPAN"!==e.nodeName)return!1;var t=e;if(!t.classList.contains("math"))return!1;var n=t.querySelector("script");return!!n&&r.innerHTML===n.innerHTML}},s=0,c=Array.from(a.querySelectorAll("span.math"));s<c.length;s++){u(c[s])}e(this.dom,a,{childrenOnly:!0}),o&&t.handlePromise(r.mathProcessor([this.dom],i))},n}();exports.UpdatePreview=n;
},{"./mathjax-helper":6,"./util":7}],4:[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function l(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,l)}u((r=r.apply(e,t||[])).next())})},t=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},r=this;exports.__esModule=!0;var o,i=require("electron"),a=require("./update-preview"),l=require("./mathjax-helper"),u=n(require("./util"));i.ipcRenderer.on("style",function(e,t){var n=t.styles,r=document.head.querySelector("style#atom-styles");r||((r=document.createElement("style")).id="atom-styles",document.head.appendChild(r)),r.innerHTML=n.join("\n")}),i.ipcRenderer.on("update-images",function(e,t){for(var n=t.oldsrc,r=t.v,o=document.querySelectorAll("img[src]"),i=0,a=Array.from(o);i<a.length;i++){var l=a[i],u=void 0,c=void 0,d=l.getAttribute("src"),s=d.match(/^(.*)\?v=(\d+)$/);s&&(d=s[1],u=s[2]),d===n&&(void 0!==u&&(c=parseInt(u,10)),r!==c&&(l.src=r?d+"?v="+r:""+d))}}),i.ipcRenderer.on("sync",function(e,t){var n=t.pathToToken,r=document.querySelector("div.update-preview");if(r){for(var o=0,i=n;o<i.length;o++){var a=i[o],l=r.querySelectorAll(":scope > "+a.tag).item(a.index);if(!l)break;r=l}if(!r.classList.contains("update-preview")){r.classList.contains("update-preview")||r.scrollIntoView();var u=document.body.scrollHeight-document.body.clientHeight;document.body.scrollTop>=u||(document.body.scrollTop-=document.body.clientHeight/4),r.classList.add("flash"),setTimeout(function(){return r.classList.remove("flash")},1e3)}}}),i.ipcRenderer.on("use-github-style",function(e,t){var n=t.value,r=document.querySelector("markdown-preview-plus-view");if(!r)throw new Error("Can't find MPP-view");n?r.setAttribute("data-use-github-style",""):r.removeAttribute("data-use-github-style")}),i.ipcRenderer.on("update-preview",function(e,t){var n=t.html,r=t.renderLaTeX,i=t.mjrenderer,l=document.querySelector("div.update-preview");if(l){o||(o=new a.UpdatePreview(l));for(var u=(new DOMParser).parseFromString(n,"text/html"),c=document.createDocumentFragment(),d=0,s=Array.from(u.body.childNodes);d<s.length;d++){var h=s[d];c.appendChild(h)}o.update(c,r,i);var p=document;if(p&&u.head.hasChildNodes){var f=p.head.querySelector("original-elements");f||(f=p.createElement("original-elements"),p.head.appendChild(f)),f.innerHTML="";for(var v=0,m=Array.from(u.head.childNodes);v<m.length;v++){var w=m[v];f.appendChild(w.cloneNode(!0))}}}}),window.atomHome=new Promise(function(e){return window.resolveAtomHome=e}),i.ipcRenderer.on("set-atom-home",function(e,t){var n=t.home;window.resolveAtomHome(n)});var c,d=document.createElement("base");document.head.appendChild(d),i.ipcRenderer.on("set-base-path",function(e,t){var n=t.path;d.href=n||""}),i.ipcRenderer.on("error",function(e,t){var n=t.msg,r=document.querySelector("div.update-preview");if(r){var o=document.createElement("div");o.innerHTML="<h2>Previewing Markdown Failed</h2><h3>"+n+"</h3>",r.appendChild(o)}}),document.addEventListener("mousewheel",function(e){e.ctrlKey&&(e.wheelDeltaY>0?i.ipcRenderer.sendToHost("zoom-in",void 0):e.wheelDeltaY<0&&i.ipcRenderer.sendToHost("zoom-out",void 0),e.preventDefault(),e.stopPropagation())}),document.addEventListener("contextmenu",function(e){c=e.target}),i.ipcRenderer.on("sync-source",function(e,t){var n=t.tokens,r=c,o=u.getPathToElement(r);if(o.shift(),o.shift(),!o.length)return null;for(var a=null,l=0,d=0,s=n;d<s.length;d++){var h=s[d];if(h.level<l)break;if(!h.hidden){if(h.tag===o[0].tag&&h.level===l)if(1===h.nesting)0===o[0].index?(null!=h.map&&(a=h),o.shift(),l++):o[0].index--;else if(0===h.nesting&&["math","code","hr"].includes(h.tag)){if(0===o[0].index){a=h;break}o[0].index--}if(0===o.length)break}}return null!==a?(i.ipcRenderer.sendToHost("open-source",{initialLine:a.map[0]}),a.map[0]):null}),i.ipcRenderer.on("get-html-svg",function(){return e(r,void 0,void 0,function(){var e,n;return t(this,function(t){switch(t.label){case 0:return(e=document.querySelector("markdown-preview-plus-view > div"))?[4,l.processHTMLString(e)]:(i.ipcRenderer.sendToHost("html-svg-result",void 0),[2]);case 1:return n=t.sent(),i.ipcRenderer.sendToHost("html-svg-result",n),[2]}})})}),window.onbeforeunload=function(){return!1};
},{"./update-preview":5,"./mathjax-helper":6,"./util":7}]},{},[4])
//# sourceMappingURL=main.b9f3301d.map