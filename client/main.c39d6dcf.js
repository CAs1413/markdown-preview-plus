parcelRequire=function(e,r,n,t){var i="function"==typeof parcelRequire&&parcelRequire,o="function"==typeof require&&require;function u(n,t){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!t&&f)return f(n,!0);if(i)return i(n,!0);if(o&&"string"==typeof n)return o(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[n][1][r]||r},p.cache={};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,p,l,l.exports,this)}return r[n].exports;function p(e){return u(p.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=i,u.register=function(r,n){e[r]=[function(e,r){r.exports=n},{}]};for(var f=0;f<n.length;f++)u(n[f]);if(n.length){var c=u(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):t&&(this[t]=c)}return u}({"oWGu":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function l(e){try{a(n.next(e))}catch(t){o(t)}}function u(e){try{a(n.throw(e))}catch(t){o(t)}}function a(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(l,u)}a((n=n.apply(e,t||[])).next())})},t=this&&this.__generator||function(e,t){var r,n,i,o,l={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return l.label++,{value:o[1],done:!1};case 5:l.label++,n=o[1],o=[0];continue;case 7:o=l.ops.pop(),l.trys.pop();continue;default:if(!(i=(i=l.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){l=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){l.label=o[1];break}if(6===o[0]&&l.label<i[1]){l.label=i[1],i=o;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(o);break}i[2]&&l.ops.pop(),l.trys.pop();continue}o=t.call(e,l)}catch(u){o=[6,u],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}};exports.__esModule=!0;var r=require("morphdom"),n=function(){function n(e,t){this.dom=e,this.mjController=t}return n.prototype.update=function(n,i){return e(this,void 0,Promise,function(){var e,o,l,u,a,s,c;return t(this,function(t){for(e=function(e){var t=e.firstElementChild;if(!t||"SCRIPT"!==t.nodeName)return"continue";e.isSameNode=function(e){if("SPAN"!==e.nodeName)return!1;var r=e;if(!r.classList.contains("math"))return!1;var n=r.querySelector("script");return!!n&&(t.innerHTML===n.innerHTML&&t.type===n.type)}},o=0,l=Array.from(n.querySelectorAll("span.math"));o<l.length;o++)u=l[o],e(u);for(r(this.dom,n,{childrenOnly:!0}),a=0,s=this.dom.querySelectorAll("li");a<s.length;a++)(c=s[a]).firstElementChild&&c.firstElementChild===c.lastElementChild&&"P"===c.firstElementChild.tagName&&c.firstChild&&c.firstChild.nodeType===Node.TEXT_NODE&&"\n"===c.firstChild.textContent&&c.removeChild(c.firstChild);return i?[2,this.mjController.queueTypeset(this.dom)]:[2]})})},n}();exports.UpdatePreview=n;
},{}],"BHXf":[function(require,module,exports) {
"use strict";function e(e){e&&e.catch(function(e){console.error(e)})}exports.__esModule=!0,exports.handlePromise=e;var r=require("fs");function t(e){return!!r.existsSync(e)&&r.lstatSync(e).isFile()}function n(e,r){for(var t=e,n=0,o=r;n<o.length;n++){var s=o[n],i=t.querySelectorAll(":scope > "+s.tag).item(s.index);if(!i)break;t=i}if(t!==e)return t}exports.isFileSync=t,exports.resolveElement=n;
},{}],"gMOt":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{s(r.next(e))}catch(t){a(t)}}function u(e){try{s(r.throw(e))}catch(t){a(t)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,u)}s((r=r.apply(e,t||[])).next())})},t=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(u){a=[6,u],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}};exports.__esModule=!0;var n=require("path"),r=require("season"),o=require("fs"),a=require("./util"),i=function(){function n(e,t){this.atomHome=e,this.mathJaxConfig=t,this.readyPromise=this.attachMathJax()}return n.create=function(r,o){return e(this,void 0,void 0,function(){var e;return t(this,function(t){switch(t.label){case 0:return[4,(e=new n(r,o)).readyPromise];case 1:return t.sent(),[2,e]}})})},n.prototype.processHTMLString=function(e){var t=document.getElementById("MathJax_SVG_Hidden"),n=t&&t.parentElement;return null!==n?n.outerHTML+e.innerHTML:e.innerHTML},n.prototype.rerenderMath=function(){return e(this,void 0,void 0,function(){return t(this,function(e){return[2,new Promise(function(e){MathJax.Hub.Queue(["Rerender",MathJax.Hub]),MathJax.Hub.Queue([e])})]})})},n.prototype.dispose=function(){var e=document.head.querySelector("script[src='"+n.mjSrc+"']");e&&e.remove()},n.prototype.jaxTeXConfig=function(){var e=c(this.atomHome);return e=e?h(e):{},{extensions:this.mathJaxConfig.texExtensions,Macros:e,equationNumbers:this.mathJaxConfig.numberEquations?{autoNumber:"AMS",useLabelIds:!1}:{}}},n.prototype.queueTypeset=function(n){return e(this,void 0,void 0,function(){var e=this;return t(this,function(t){return Array.from(document.querySelectorAll('script[type^="math/tex"]')).some(function(e){return!e.id})?[2,new Promise(function(t){MathJax.InputJax.TeX&&(MathJax.Hub.Queue(["resetEquationNumbers",MathJax.InputJax.TeX]),e.mathJaxConfig.numberEquations&&(MathJax.Hub.Queue(["PreProcess",MathJax.Hub]),MathJax.Hub.Queue(["Reprocess",MathJax.Hub]))),MathJax.Hub.Queue(["Typeset",MathJax.Hub,n]),MathJax.Hub.Queue([t])})]:[2]})})},n.prototype.attachMathJax=function(){return e(this,void 0,Promise,function(){return t(this,function(e){switch(e.label){case 0:return console.log("Loading maths rendering engine MathJax"),[4,d(n.mjSrc)];case 1:return e.sent(),MathJax.Hub.Config({jax:["input/TeX","output/"+this.mathJaxConfig.latexRenderer],extensions:[],TeX:this.jaxTeXConfig(),"HTML-CSS":{availableFonts:[],webFont:"TeX",imageFont:null,undefinedFamily:this.mathJaxConfig.undefinedFamily,mtextFontInherit:!0},messageStyle:"none",showMathMenu:!1,skipStartupTypeset:!0}),MathJax.Hub.Configured(),console.log("Loaded maths rendering engine MathJax"),[2]}})})},n.mjSrc=global.require.resolve("mathjax")+"?delayStartupUntil=configured",n}();function u(e){var t=r.resolve(n.join(e,"markdown-preview-plus"));return null!=t?t:n.join(e,"markdown-preview-plus.cson")}function s(e){return r.isObjectPath(e)?r.readFileSync(e,function(t,n){return void 0===n&&(n={}),void 0!==t&&(console.warn("Error reading Latex Macros file '"+e+"': "+(void 0!==t.stack?t.stack:t)),console.error("Failed to load Latex Macros from '"+e+"'",{detail:t.message,dismissable:!0})),n}):{}}function c(e){var t=u(e);return a.isFileSync(t)?s(t):(console.debug("Creating markdown-preview-plus.cson, this is a one-time operation."),l(t),s(t))}function l(e){var t=n.join(__dirname,"../assets/macros-template.cson"),r=o.readFileSync(t,"utf8");o.writeFileSync(e,r)}function h(e){var t=/^[^a-zA-Z\d\s]$|^[a-zA-Z]*$/;for(var n in e){var r=e[n];n.match(t)&&f(r)||(delete e[n],console.error("Failed to load LaTeX macro named '"+n+"'. Please see the [LaTeX guide](https://github.com/atom-community/markdown-preview-plus/blob/master/docs/math.md#macro-names)"))}return e}function f(e){if(Array.isArray(e)){var t=e[0],n=e[1];return"number"==typeof n&&(n%1==0&&"string"==typeof t)}return"string"==typeof e}function d(n){return e(this,void 0,void 0,function(){var e;return t(this,function(t){return(e=document.createElement("script")).src=n,e.type="text/javascript",document.head.appendChild(e),[2,new Promise(function(t){e.addEventListener("load",function(){return t()})})]})})}exports.MathJaxController=i;
},{"./util":"BHXf"}],"fQo0":[function(require,module,exports) {
"use strict";function e(e){return e.querySelectorAll("img[src],audio[src],video[src],link[href]")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getMedia=e;
},{}],"ZCfc":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function u(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(a,u)}c((n=n.apply(e,t||[])).next())})},t=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(u){i=[6,u],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},n=this;exports.__esModule=!0;var o=require("electron"),i=require("./update-preview"),a=require("./mathjax-helper"),u=r(require("./util")),c=require("../src/util-common");function d(){var e,t=new Promise(function(t){return e=t});return t.resolve=e,t}window.addEventListener("error",function(e){var t=e.error;o.ipcRenderer.sendToHost("uncaught-error",{message:t.message,name:t.name,stack:t.stack})}),window.addEventListener("unhandledrejection",function(e){var t=e.reason;o.ipcRenderer.sendToHost("uncaught-error",{message:t.message,name:t.name,stack:t.stack})});var s,l={mathJax:d(),sourceLineMap:new Map,revSourceMap:new WeakMap,defaultPreviewContext:"live-preview"};o.ipcRenderer.on("init",function(e,t){var r=t.atomHome,n=t.mathJaxConfig,o=t.context;l.mathJax.resolve(a.MathJaxController.create(r,n)),l.defaultPreviewContext=o,document.documentElement.dataset.markdownPreviewPlusContext=o}),o.ipcRenderer.on("set-source-map",function(e,t){var r=t.map,n=document.querySelector("div.update-preview");if(!n)throw new Error("No root element!");for(var o=new Map,i=new WeakMap,a=0,c=Object.keys(r);a<c.length;a++){var d=c[a],s=parseInt(d,10),p=r[s],f=u.resolveElement(n,p);if(f){o.set(s,f);var m=i.get(f);m?m.push(s):i.set(f,[s])}}l.sourceLineMap=o,l.revSourceMap=i}),o.ipcRenderer.on("scroll-sync",function(e,t){var r,n,o=t.firstLine,i=t.lastLine,a=Math.floor(.5*(o+i)),u=l.sourceLineMap;for(r=a;r>=0&&!(n=u.get(r));r-=1);if(n){var c,d,s=Math.max.apply(Math,Array.from(u.keys()));for(c=a+1;c<s&&!(d=u.get(c));c+=1);if(d){var p=n.getBoundingClientRect().top,f=d.getBoundingClientRect().top,m=(a-o)/(i-o),v=document.documentElement.scrollTop-document.documentElement.clientHeight/2+p+m*(f-p);window.scroll({top:v})}}}),o.ipcRenderer.on("style",function(e,t){var r=t.styles,n=document.head.querySelector("style#atom-styles");n||((n=document.createElement("style")).id="atom-styles",document.head.appendChild(n)),n.innerHTML=r.join("\n")}),o.ipcRenderer.on("update-images",function(e,t){for(var r=t.oldsrc,n=t.v,o=c.getMedia(document),i=0,a=Array.from(o);i<a.length;i++){var u=a[i],d=void 0,s=void 0,l=void 0;l="LINK"===u.tagName?"href":"src";var p=u.getAttribute(l),f=p.match(/^(.*)\?v=(\d+)$/);f&&(p=f[1],d=f[2]),p===r&&(void 0!==d&&(s=parseInt(d,10)),n!==s&&(u[l]=n?p+"?v="+n:""+p))}}),o.ipcRenderer.on("sync",function(e,t){var r=t.line,n=t.flash;if(document.querySelector("div.update-preview")){var o=l.sourceLineMap.get(r);if(!o)for(var i=r-1;i>=0&&!(o=l.sourceLineMap.get(r));i-=1);o&&(o.scrollIntoViewIfNeeded(!0),n&&(o.classList.add("flash"),setTimeout(function(){return o.classList.remove("flash")},1e3)))}}),o.ipcRenderer.on("update-preview",function(r,a){var u=a.id,c=a.html,d=a.renderLaTeX;return e(n,void 0,void 0,function(){var e,r,n,a,p,f,m,v,h,w,y,g,x,M;return t(this,function(t){switch(t.label){case 0:return(e=document.querySelector("div.update-preview"))?s?[3,2]:(r=i.UpdatePreview.bind,n=[void 0,e],[4,l.mathJax]):[2];case 1:s=new(r.apply(i.UpdatePreview,n.concat([t.sent()]))),t.label=2;case 2:if(a=new DOMParser,p=a.parseFromString(c,"text/html"),(f=document)&&p.head.hasChildNodes)for((m=f.head.querySelector("original-elements"))||(m=f.createElement("original-elements"),f.head.appendChild(m)),m.innerHTML="",v=0,h=Array.from(p.head.childNodes);v<h.length;v++)w=h[v],m.appendChild(w);return[4,s.update(p.body,d)];case 3:return t.sent(),g=(y=o.ipcRenderer).sendToHost,x=["request-reply"],M={id:u,request:"update-preview"},[4,l.mathJax];case 4:return g.apply(y,x.concat([(M.result=t.sent().processHTMLString(e),M)])),[2]}})})});var p,f=document.createElement("base");document.head.appendChild(f),o.ipcRenderer.on("set-base-path",function(e,t){var r=t.path;f.href=r||""}),o.ipcRenderer.on("error",function(e,t){var r=t.msg,n=document.querySelector("div.update-preview");if(n){var o=document.createElement("div");o.innerHTML="<h2>Previewing Markdown Failed</h2><h3>"+r+"</h3>",n.appendChild(o)}}),document.addEventListener("wheel",function(e){e.ctrlKey&&(e.wheelDeltaY>0?o.ipcRenderer.sendToHost("zoom-in",void 0):e.wheelDeltaY<0&&o.ipcRenderer.sendToHost("zoom-out",void 0),e.preventDefault(),e.stopPropagation())}),document.addEventListener("scroll",function(e){var t=document.documentElement.clientHeight,r=Array.from(l.sourceLineMap.entries()).filter(function(e){e[0];var r=e[1].getBoundingClientRect(),n=r.top,o=r.bottom;return n>0&&o<t}).map(function(e){var t=e[0];e[1];return t});o.ipcRenderer.sendToHost("did-scroll-preview",{max:Math.max.apply(Math,r),min:Math.min.apply(Math,r)})}),document.addEventListener("contextmenu",function(e){p=e.target}),o.ipcRenderer.on("sync-source",function(e,t){for(var r=t.id,n=p,i=l.revSourceMap,a=i.get(n);!a&&n.parentElement;)n=n.parentElement,a=i.get(n);a&&o.ipcRenderer.sendToHost("request-reply",{id:r,request:"sync-source",result:Math.min.apply(Math,a)})}),o.ipcRenderer.on("reload",function(e,t){var r=t.id;window.onbeforeunload=null,o.ipcRenderer.sendToHost("request-reply",{id:r,request:"reload",result:void 0})}),window.onbeforeunload=function(){return!1},o.ipcRenderer.on("get-tex-config",function(r,i){var a=i.id;return e(n,void 0,void 0,function(){var e,r,n,i;return t(this,function(t){switch(t.label){case 0:return r=(e=o.ipcRenderer).sendToHost,n=["request-reply"],i={id:a,request:"get-tex-config"},[4,l.mathJax];case 1:return r.apply(e,n.concat([(i.result=t.sent().jaxTeXConfig(),i)])),[2]}})})}),o.ipcRenderer.on("prepare-pdf-export",function(r,i){var a=i.id,u=i.width;return e(n,void 0,void 0,function(){return t(this,function(e){switch(e.label){case 0:return document.documentElement.style.setProperty("width",u+"mm","important"),document.documentElement.dataset.markdownPreviewPlusContext="pdf-export",[4,l.mathJax];case 1:return[4,e.sent().rerenderMath()];case 2:return e.sent(),o.ipcRenderer.sendToHost("request-reply",{id:a,request:"prepare-pdf-export",result:void 0}),[2]}})})}),o.ipcRenderer.on("finished-pdf-export",function(r,i){var a=i.id;return e(n,void 0,void 0,function(){return t(this,function(e){switch(e.label){case 0:return document.documentElement.style.removeProperty("width"),document.documentElement.dataset.markdownPreviewPlusContext=l.defaultPreviewContext,[4,l.mathJax];case 1:return[4,e.sent().rerenderMath()];case 2:return e.sent(),o.ipcRenderer.sendToHost("request-reply",{id:a,request:"finished-pdf-export",result:void 0}),[2]}})})}),o.ipcRenderer.on("get-selection",function(r,i){var a=i.id;return e(n,void 0,void 0,function(){var e,r,n;return t(this,function(t){return e=window.getSelection(),r=e.toString(),n=e.baseNode,o.ipcRenderer.sendToHost("request-reply",{id:a,request:"get-selection",result:r&&n?r:void 0}),[2]})})});
},{"./update-preview":"oWGu","./mathjax-helper":"gMOt","./util":"BHXf","../src/util-common":"fQo0"}]},{},["ZCfc"], null)
//# sourceMappingURL=main.c39d6dcf.map