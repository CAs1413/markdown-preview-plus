parcelRequire=function(e,r,n,t){var i="function"==typeof parcelRequire&&parcelRequire,o="function"==typeof require&&require;function u(n,t){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!t&&f)return f(n,!0);if(i)return i(n,!0);if(o&&"string"==typeof n)return o(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[n][1][r]||r},p.cache={};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,p,l,l.exports,this)}return r[n].exports;function p(e){return u(p.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=i,u.register=function(r,n){e[r]=[function(e,r){r.exports=n},{}]};for(var f=0;f<n.length;f++)u(n[f]);if(n.length){var c=u(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):t&&(this[t]=c)}return u}({"BHXf":[function(require,module,exports) {
"use strict";function e(e){e&&e.catch(function(e){console.error(e)})}exports.__esModule=!0,exports.handlePromise=e;var r=require("fs");function t(e){return!!r.existsSync(e)&&r.lstatSync(e).isFile()}function n(e,r){for(var t=e,n=0,o=r;n<o.length;n++){var s=o[n],i=t.querySelectorAll(":scope > "+s.tag).item(s.index);if(!i)break;t=i}if(t!==e)return t}exports.isFileSync=t,exports.resolveElement=n;
},{}],"gMOt":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{s(r.next(e))}catch(t){a(t)}}function u(e){try{s(r.throw(e))}catch(t){a(t)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,u)}s((r=r.apply(e,t||[])).next())})},t=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(u){a=[6,u],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}};exports.__esModule=!0;var n,r=require("path"),o=require("season"),a=require("fs"),i=require("./util"),u=global.require.resolve("mathjax")+"?delayStartupUntil=configured";function s(n,r,o){return e(this,void 0,void 0,function(){return t(this,function(e){switch(e.label){case 0:return[4,d(r,o)];case 1:return e.sent(),[4,g(o,n)];case 2:return e.sent(),[2]}})})}function c(e){var t=document.getElementById("MathJax_SVG_Hidden"),n=t&&t.parentElement;return null!==n?n.innerHTML+e.innerHTML:e.innerHTML}function l(){return e(this,void 0,void 0,function(){return t(this,function(e){switch(e.label){case 0:return void 0===n?[3,2]:[4,n];case 1:return e.sent(),[2,new Promise(function(e){MathJax.Hub.Queue(["Rerender",MathJax.Hub]),MathJax.Hub.Queue([e])})];case 2:return[2]}})})}function d(r,o){return e(this,void 0,Promise,function(){return t(this,function(e){return n?[2,n]:[2,n=M(r,o)]})})}function f(){n=void 0;var e=document.head.querySelector("script[src='"+u+"']");e&&e.remove()}function h(e,t){var n=b(e);return n=n?x(n):{},{extensions:t.texExtensions,Macros:n,equationNumbers:t.numberEquations?{autoNumber:"AMS",useLabelIds:!1}:{}}}function m(e){var t=o.resolve(r.join(e,"markdown-preview-plus"));return null!=t?t:r.join(e,"markdown-preview-plus.cson")}function p(e){return o.isObjectPath(e)?o.readFileSync(e,function(t,n){return void 0===n&&(n={}),void 0!==t&&(console.warn("Error reading Latex Macros file '"+e+"': "+(void 0!==t.stack?t.stack:t)),console.error("Failed to load Latex Macros from '"+e+"'",{detail:t.message,dismissable:!0})),n}):{}}function b(e){var t=m(e);return i.isFileSync(t)?p(t):(console.debug("Creating markdown-preview-plus.cson, this is a one-time operation."),v(t),p(t))}function v(e){var t=r.join(__dirname,"../assets/macros-template.cson"),n=a.readFileSync(t,"utf8");a.writeFileSync(e,n)}function x(e){var t=/^[^a-zA-Z\d\s]$|^[a-zA-Z]*$/;for(var n in e){var r=e[n];n.match(t)&&y(r)||(delete e[n],console.error("Failed to load LaTeX macro named '"+n+"'. Please see the [LaTeX guide](https://github.com/atom-community/markdown-preview-plus/blob/master/docs/math.md#macro-names)"))}return e}function y(e){if(Array.isArray(e)){var t=e[0],n=e[1];return"number"==typeof n&&(n%1==0&&"string"==typeof t)}return"string"==typeof e}function M(n,r){return e(this,void 0,Promise,function(){return t(this,function(e){switch(e.label){case 0:return console.log("Loading maths rendering engine MathJax"),[4,w(u)];case 1:return e.sent(),MathJax.Hub.Config({jax:["input/TeX","output/"+r.renderer],extensions:[],TeX:h(n,r),"HTML-CSS":{availableFonts:[],webFont:"TeX",imageFont:null,undefinedFamily:r.undefinedFamily,mtextFontInherit:!0},messageStyle:"none",showMathMenu:!1,skipStartupTypeset:!0}),MathJax.Hub.Configured(),console.log("Loaded maths rendering engine MathJax"),[2]}})})}function w(n){return e(this,void 0,void 0,function(){var e;return t(this,function(t){return(e=document.createElement("script")).src=n,e.type="text/javascript",document.head.appendChild(e),[2,new Promise(function(t){e.addEventListener("load",function(){return t()})})]})})}function g(n,r){return e(this,void 0,void 0,function(){return t(this,function(e){return Array.from(document.querySelectorAll('script[type^="math/tex"]')).some(function(e){return!e.id})?[2,new Promise(function(e){MathJax.InputJax.TeX&&(MathJax.Hub.Queue(["resetEquationNumbers",MathJax.InputJax.TeX]),n.numberEquations&&(MathJax.Hub.Queue(["PreProcess",MathJax.Hub]),MathJax.Hub.Queue(["Reprocess",MathJax.Hub]))),MathJax.Hub.Queue(["Typeset",MathJax.Hub,r]),MathJax.Hub.Queue([e])})]:[2]})})}exports.mathProcessor=s,exports.processHTMLString=c,exports.rerenderMath=l,exports.unloadMathJax=f,exports.jaxTeXConfig=h;
},{"./util":"BHXf"}],"oWGu":[function(require,module,exports) {
"use strict";var t=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(i,o){function a(t){try{u(n.next(t))}catch(e){o(e)}}function l(t){try{u(n.throw(t))}catch(e){o(e)}}function u(t){t.done?i(t.value):new r(function(e){e(t.value)}).then(a,l)}u((n=n.apply(t,e||[])).next())})},e=this&&this.__generator||function(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(l){o=[6,l],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}};exports.__esModule=!0;var r=require("morphdom"),n=require("./mathjax-helper"),i=function(){function i(t,e,r){this.dom=t,this.atomHome=e,this.mathJaxConfig=r}return i.prototype.update=function(i,o){return t(this,void 0,Promise,function(){var t,a,l,u,s,c,h;return e(this,function(e){for(t=function(t){var e=t.firstElementChild;if(!e||"SCRIPT"!==e.nodeName)return"continue";t.isSameNode=function(t){if("SPAN"!==t.nodeName)return!1;var r=t;if(!r.classList.contains("math"))return!1;var n=r.querySelector("script");return!!n&&(e.innerHTML===n.innerHTML&&e.type===n.type)}},a=0,l=Array.from(i.querySelectorAll("span.math"));a<l.length;a++)u=l[a],t(u);for(r(this.dom,i,{childrenOnly:!0}),s=0,c=this.dom.querySelectorAll("li");s<c.length;s++)(h=c[s]).firstElementChild&&h.firstElementChild===h.lastElementChild&&"P"===h.firstElementChild.tagName&&h.firstChild&&h.firstChild.nodeType===Node.TEXT_NODE&&"\n"===h.firstChild.textContent&&h.removeChild(h.firstChild);return o?[2,n.mathProcessor(this.dom,this.atomHome,this.mathJaxConfig)]:[2]})})},i}();exports.UpdatePreview=i;
},{"./mathjax-helper":"gMOt"}],"fQo0":[function(require,module,exports) {
"use strict";function e(e){return e.querySelectorAll("img[src],audio[src],video[src],link[href]")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getMedia=e;
},{}],"ZCfc":[function(require,module,exports) {
"use strict";var e=this&&this.__assign||function(){return(e=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},t=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{u(n.next(e))}catch(t){i(t)}}function c(e){try{u(n.throw(e))}catch(t){i(t)}}function u(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(a,c)}u((n=n.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(c){i=[6,c],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},o=this;exports.__esModule=!0;var i=require("electron"),a=require("./update-preview"),c=require("./mathjax-helper"),u=n(require("./util")),d=require("../src/util-common");function s(){var e,t=new Promise(function(t){return e=t});return t.resolve=e,t}window.addEventListener("error",function(e){var t=e.error;i.ipcRenderer.sendToHost("uncaught-error",{message:t.message,name:t.name,stack:t.stack})}),window.addEventListener("unhandledrejection",function(e){var t=e.reason;i.ipcRenderer.sendToHost("uncaught-error",{message:t.message,name:t.name,stack:t.stack})});var l,p={home:s(),mathJaxConfig:s(),sourceLineMap:new Map,revSourceMap:new WeakMap,defaultPreviewContext:"live-preview"};i.ipcRenderer.on("init",function(t,r){var n=r.atomHome,o=r.mathJaxConfig,i=r.mathJaxRenderer,a=r.context;p.home.resolve(n),p.mathJaxConfig.resolve(e({},o,{renderer:i})),p.defaultPreviewContext=a,document.documentElement.dataset.markdownPreviewPlusContext=a}),i.ipcRenderer.on("set-source-map",function(e,t){var r=t.map,n=document.querySelector("div.update-preview");if(!n)throw new Error("No root element!");for(var o=new Map,i=new WeakMap,a=0,c=Object.keys(r);a<c.length;a++){var d=c[a],s=parseInt(d,10),l=r[s],f=u.resolveElement(n,l);if(f){o.set(s,f);var v=i.get(f);v?v.push(s):i.set(f,[s])}}p.sourceLineMap=o,p.revSourceMap=i}),i.ipcRenderer.on("scroll-sync",function(e,t){var r,n,o=t.firstLine,i=t.lastLine,a=Math.floor(.5*(o+i)),c=p.sourceLineMap;for(r=a;r>=0&&!(n=c.get(r));r-=1);if(n){var u,d,s=Math.max.apply(Math,Array.from(c.keys()));for(u=a+1;u<s&&!(d=c.get(u));u+=1);if(d){var l=n.getBoundingClientRect().top,f=d.getBoundingClientRect().top,v=(a-o)/(i-o),m=document.documentElement.scrollTop-document.documentElement.clientHeight/2+l+v*(f-l);window.scroll({top:m})}}}),i.ipcRenderer.on("style",function(e,t){var r=t.styles,n=document.head.querySelector("style#atom-styles");n||((n=document.createElement("style")).id="atom-styles",document.head.appendChild(n)),n.innerHTML=r.join("\n")}),i.ipcRenderer.on("update-images",function(e,t){for(var r=t.oldsrc,n=t.v,o=d.getMedia(document),i=0,a=Array.from(o);i<a.length;i++){var c=a[i],u=void 0,s=void 0,l=void 0;l="LINK"===c.tagName?"href":"src";var p=c.getAttribute(l),f=p.match(/^(.*)\?v=(\d+)$/);f&&(p=f[1],u=f[2]),p===r&&(void 0!==u&&(s=parseInt(u,10)),n!==s&&(c[l]=n?p+"?v="+n:""+p))}}),i.ipcRenderer.on("sync",function(e,t){var r=t.line,n=t.flash;if(document.querySelector("div.update-preview")){var o=p.sourceLineMap.get(r);if(!o)for(var i=r-1;i>=0&&!(o=p.sourceLineMap.get(r));i-=1);o&&(o.scrollIntoViewIfNeeded(!0),n&&(o.classList.add("flash"),setTimeout(function(){return o.classList.remove("flash")},1e3)))}}),i.ipcRenderer.on("update-preview",function(e,n){var u=n.id,d=n.html,s=n.renderLaTeX;return t(o,void 0,void 0,function(){var e,t,n,o,f,v,m,h,w,y;return r(this,function(r){switch(r.label){case 0:return(e=document.querySelector("div.update-preview"))?l?[3,3]:(t=a.UpdatePreview.bind,n=[void 0,e],[4,p.home]):[2];case 1:return n=n.concat([r.sent()]),[4,p.mathJaxConfig];case 2:l=new(t.apply(a.UpdatePreview,n.concat([r.sent()]))),r.label=3;case 3:if(o=new DOMParser,f=o.parseFromString(d,"text/html"),(v=document)&&f.head.hasChildNodes)for((m=v.head.querySelector("original-elements"))||(m=v.createElement("original-elements"),v.head.appendChild(m)),m.innerHTML="",h=0,w=Array.from(f.head.childNodes);h<w.length;h++)y=w[h],m.appendChild(y);return[4,l.update(f.body,s)];case 4:return r.sent(),i.ipcRenderer.sendToHost("request-reply",{id:u,request:"update-preview",result:c.processHTMLString(e)}),[2]}})})});var f,v=document.createElement("base");document.head.appendChild(v),i.ipcRenderer.on("set-base-path",function(e,t){var r=t.path;v.href=r||""}),i.ipcRenderer.on("error",function(e,t){var r=t.msg,n=document.querySelector("div.update-preview");if(n){var o=document.createElement("div");o.innerHTML="<h2>Previewing Markdown Failed</h2><h3>"+r+"</h3>",n.appendChild(o)}}),document.addEventListener("wheel",function(e){e.ctrlKey&&(e.wheelDeltaY>0?i.ipcRenderer.sendToHost("zoom-in",void 0):e.wheelDeltaY<0&&i.ipcRenderer.sendToHost("zoom-out",void 0),e.preventDefault(),e.stopPropagation())}),document.addEventListener("scroll",function(e){var t=document.documentElement.clientHeight,r=Array.from(p.sourceLineMap.entries()).filter(function(e){e[0];var r=e[1].getBoundingClientRect(),n=r.top,o=r.bottom;return n>0&&o<t}).map(function(e){var t=e[0];e[1];return t});i.ipcRenderer.sendToHost("did-scroll-preview",{max:Math.max.apply(Math,r),min:Math.min.apply(Math,r)})}),document.addEventListener("contextmenu",function(e){f=e.target}),i.ipcRenderer.on("sync-source",function(e,t){for(var r=t.id,n=f,o=p.revSourceMap,a=o.get(n);!a&&n.parentElement;)n=n.parentElement,a=o.get(n);a&&i.ipcRenderer.sendToHost("request-reply",{id:r,request:"sync-source",result:Math.min.apply(Math,a)})}),i.ipcRenderer.on("reload",function(e,t){var r=t.id;window.onbeforeunload=null,i.ipcRenderer.sendToHost("request-reply",{id:r,request:"reload",result:void 0})}),window.onbeforeunload=function(){return!1},i.ipcRenderer.on("get-tex-config",function(e,n){var a=n.id;return t(o,void 0,void 0,function(){var e,t,n,o,u,d;return r(this,function(r){switch(r.label){case 0:return t=(e=i.ipcRenderer).sendToHost,n=["request-reply"],o={id:a,request:"get-tex-config"},u=c.jaxTeXConfig,[4,p.home];case 1:return d=[r.sent()],[4,p.mathJaxConfig];case 2:return t.apply(e,n.concat([(o.result=u.apply(void 0,d.concat([r.sent()])),o)])),[2]}})})}),i.ipcRenderer.on("prepare-pdf-export",function(e,n){var a=n.id,u=n.width;return t(o,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return document.documentElement.style.setProperty("width",u+"mm","important"),document.documentElement.dataset.markdownPreviewPlusContext="pdf-export",[4,c.rerenderMath()];case 1:return e.sent(),i.ipcRenderer.sendToHost("request-reply",{id:a,request:"prepare-pdf-export",result:void 0}),[2]}})})}),i.ipcRenderer.on("finished-pdf-export",function(e,n){var a=n.id;return t(o,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return document.documentElement.style.removeProperty("width"),document.documentElement.dataset.markdownPreviewPlusContext=p.defaultPreviewContext,[4,c.rerenderMath()];case 1:return e.sent(),i.ipcRenderer.sendToHost("request-reply",{id:a,request:"finished-pdf-export",result:void 0}),[2]}})})}),i.ipcRenderer.on("get-selection",function(e,n){var a=n.id;return t(o,void 0,void 0,function(){var e,t,n;return r(this,function(r){return e=window.getSelection(),t=e.toString(),n=e.baseNode,i.ipcRenderer.sendToHost("request-reply",{id:a,request:"get-selection",result:t&&n?t:void 0}),[2]})})});
},{"./update-preview":"oWGu","./mathjax-helper":"gMOt","./util":"BHXf","../src/util-common":"fQo0"}]},{},["ZCfc"], null)
//# sourceMappingURL=main.c39d6dcf.map